import ne from"./DIQE2E1e.js";import{u as V}from"./DbwGKXCe.js";import{i as v,_ as ae,g as se,o as N,h as ie,j as B,k as P,O as p,l as ce,f as le,m as ue,n as fe,r as de,p as me}from"./CVJ5owQz.js";import{d as k,a3 as E,A as h,c as U,bS as pe,al as ve,z as b,B as i,D as f,E as m,S as I,$ as _e,a0 as ye,a1 as he,Z as xe,C as R,F as g,Y as we,K as be,bT as ge}from"./DnoyKoxn.js";import{I as je}from"./ClpzhtUq.js";import Ie from"./B9Guvwyj.js";import ke from"./CGOFvrZx.js";import Se from"./BcQ4wO1c.js";import Le from"./FfmMUk3h.js";import F from"./C0sgzHhA.js";import Ce from"./D99mKXLL.js";import{Q as $e,g as T,H as Oe,u as Pe,B as Ve,v as Ue}from"./CBIecBA0.js";import{i as Ae}from"./BrKRGrco.js";import De from"./N62nXKjP.js";import z from"./Ci53oWlu.js";import Re from"./Bw6VykID.js";import Te from"./C_zBkCwX.js";import"./VZ_ZLigs.js";import"./B5C-AtoX.js";import"./_HAkkcDx.js";import"./BZjCtFDx.js";import"./DPKd5-cv.js";import"./a7gYkR0q.js";import"./CbA-0jCt.js";import"./jc0MLXVe.js";import"./ZhWAdK_X.js";import"./CMB4ACPS.js";import"./Dx-RGxfB.js";import"./mQ8dEqD_.js";import"./Bjosl62V.js";import"./C5KExJFp.js";import"./PcezX1lz.js";import"./CLs7nh7g.js";import"./BcePxw2k.js";import"./BplniLiz.js";import"./CjeBhF4K.js";import"./DwOy7wgf.js";import"./RRjIxZ14.js";import"./Cx2-T2S-.js";import"./W90eb4aB.js";import"./CqOLe7fj.js";import"./Cy-irp6H.js";import"./DllrivZD.js";import"./DDEVnlz5.js";import"./BY6gXI6W.js";import"./C3OL8Ul6.js";import"./C6E1RYka.js";import"./CBPvP6Qr.js";import"./DS22G6f9.js";import"./DOq2-aq-.js";import"./BROzlb8Y.js";import"./DJqPDDKy.js";import"./88ZMHBEO.js";import"./DVtXXJxG.js";import"./DKpEVeCR.js";function Ne(e){return v(e?.lift)}function G(e){return function(t){if(Ne(t))return t.lift(function(o){try{return e(o,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Be(e,t,o,r,n){return new Ee(e,t,o,r,n)}var Ee=(function(e){ae(t,e);function t(o,r,n,a,c,d){var l=e.call(this,o)||this;return l.onFinalize=c,l.shouldUnsubscribe=d,l._next=r?function(u){try{r(u)}catch(s){o.error(s)}}:e.prototype._next,l._error=a?function(u){try{a(u)}catch(s){o.error(s)}finally{this.unsubscribe()}}:e.prototype._error,l._complete=n?function(){try{n()}catch(u){o.error(u)}finally{this.unsubscribe()}}:e.prototype._complete,l}return t.prototype.unsubscribe=function(){var o;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),!r&&((o=this.onFinalize)===null||o===void 0||o.call(this))}},t})(se),Y=(function(e){return e&&typeof e.length=="number"&&typeof e!="function"});function Q(e){return v(e?.then)}function J(e){return v(e[N])}function H(e){return Symbol.asyncIterator&&v(e?.[Symbol.asyncIterator])}function K(e){return new TypeError("You provided "+(e!==null&&typeof e=="object"?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function Fe(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var M=Fe();function W(e){return v(e?.[M])}function Z(e){return ie(this,arguments,function(){var o,r,n,a;return B(this,function(c){switch(c.label){case 0:o=e.getReader(),c.label=1;case 1:c.trys.push([1,,9,10]),c.label=2;case 2:return[4,P(o.read())];case 3:return r=c.sent(),n=r.value,a=r.done,a?[4,P(void 0)]:[3,5];case 4:return[2,c.sent()];case 5:return[4,P(n)];case 6:return[4,c.sent()];case 7:return c.sent(),[3,2];case 8:return[3,10];case 9:return o.releaseLock(),[7];case 10:return[2]}})})}function q(e){return v(e?.getReader)}function A(e){if(e instanceof p)return e;if(e!=null){if(J(e))return ze(e);if(Y(e))return Ge(e);if(Q(e))return Ye(e);if(H(e))return X(e);if(W(e))return Qe(e);if(q(e))return Je(e)}throw K(e)}function ze(e){return new p(function(t){var o=e[N]();if(v(o.subscribe))return o.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function Ge(e){return new p(function(t){for(var o=0;o<e.length&&!t.closed;o++)t.next(e[o]);t.complete()})}function Ye(e){return new p(function(t){e.then(function(o){t.closed||(t.next(o),t.complete())},function(o){return t.error(o)}).then(null,ce)})}function Qe(e){return new p(function(t){var o,r;try{for(var n=le(e),a=n.next();!a.done;a=n.next()){var c=a.value;if(t.next(c),t.closed)return}}catch(d){o={error:d}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}t.complete()})}function X(e){return new p(function(t){He(e,t).catch(function(o){return t.error(o)})})}function Je(e){return X(Z(e))}function He(e,t){var o,r,n,a;return ue(this,void 0,void 0,function(){var c,d;return B(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),o=fe(e),l.label=1;case 1:return[4,o.next()];case 2:if(r=l.sent(),!!r.done)return[3,4];if(c=r.value,t.next(c),t.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return d=l.sent(),n={error:d},[3,11];case 6:return l.trys.push([6,,9,10]),r&&!r.done&&(a=o.return)?[4,a.call(o)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(n)throw n.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})}function x(e,t,o,r,n){r===void 0&&(r=0),n===void 0&&(n=!1);var a=t.schedule(function(){o(),n?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(a),!n)return a}function ee(e,t){return t===void 0&&(t=0),G(function(o,r){o.subscribe(Be(r,function(n){return x(r,e,function(){return r.next(n)},t)},function(){return x(r,e,function(){return r.complete()},t)},function(n){return x(r,e,function(){return r.error(n)},t)}))})}function te(e,t){return t===void 0&&(t=0),G(function(o,r){r.add(e.schedule(function(){return o.subscribe(r)},t))})}function Ke(e,t){return A(e).pipe(te(t),ee(t))}function Me(e,t){return A(e).pipe(te(t),ee(t))}function We(e,t){return new p(function(o){var r=0;return t.schedule(function(){r===e.length?o.complete():(o.next(e[r++]),o.closed||this.schedule())})})}function Ze(e,t){return new p(function(o){var r;return x(o,t,function(){r=e[M](),x(o,t,function(){var n,a,c;try{n=r.next(),a=n.value,c=n.done}catch(d){o.error(d);return}c?o.complete():o.next(a)},0,!0)}),function(){return v(r?.return)&&r.return()}})}function oe(e,t){if(!e)throw new Error("Iterable cannot be null");return new p(function(o){x(o,t,function(){var r=e[Symbol.asyncIterator]();x(o,t,function(){r.next().then(function(n){n.done?o.complete():o.next(n.value)})},0,!0)})})}function qe(e,t){return oe(Z(e),t)}function Xe(e,t){if(e!=null){if(J(e))return Ke(e,t);if(Y(e))return We(e,t);if(Q(e))return Me(e,t);if(H(e))return oe(e,t);if(W(e))return Ze(e,t);if(q(e))return qe(e,t)}throw K(e)}function et(e,t){return t?Xe(e,t):A(e)}const tt=k({__name:"ProjectUpload",setup(e){const{importProjectFile:t}=V();async function o(r){const n=r.files[0],a=await de(n);if(a&&typeof a=="string"){const c=JSON.parse(a);await t(c)}}return(r,n)=>{const a=ne;return h(),E(a,{mode:"basic","custom-upload":!0,accept:"application/json","max-file-size":100*1024*1024,auto:!0,"choose-icon":"pi pi-file-plus","choose-label":"Upload Project",onSelect:o})}}}),ot=Object.assign(tt,{__name:"ProjectUpload"});function rt(e,t){const o=U(void 0),r=e.subscribe({next:n=>o.value=n,error:void 0});return $e(()=>{r.unsubscribe()}),o}const nt=e=>rt(et(pe(e))),at={class:"row pt-2"},st={class:"col-12"},it={class:"flex flex-col"},ct={class:"flex flex-col grow gap-3"},lt={class:"flex flex-row items-start"},ut={class:"flex flex-col grow gap-1"},ft=["onClick"],dt={class:"text-sm text-surface-500"},mt={class:"flex flex-row gap-1"},pt=k({__name:"LibraryTable",setup(e){const{loadProject:t}=V(),o=ve(),r=U(""),n=nt(()=>o.projects.filter(u=>!u.deleted&&(Pe(r.value)||Ve(r.value.toLowerCase(),u.name.toLowerCase()))).toArray()),a=async u=>{await t(u)},c=async u=>{const s=await o.projects.get(u);if(s.currentVersionId){const w=await o.projects_versions.get(s.currentVersionId),S=JSON.stringify(w?.data),L=new Blob([S],{type:"application/json"}),j=URL.createObjectURL(L),_=document.createElement("a");_.style.display="none",_.download=`project-${w.id}.json`,_.href=j,document.body.appendChild(_),_.click(),URL.revokeObjectURL(j)}},d=async u=>{await o.projects.update(u,s=>{s.deleted=!0})},l=async u=>{const s=await o.projects.get(u);if(Ae(s)){const w=me(Oe(["id","currentVersionId"]),T("createdAt",new Date),T("updatedAt",new Date))(s);await o.projects.add(w)}};return(u,s)=>{const w=Ce,S=F,L=Le,j=Se,_=ke,C=je,re=Ie;return h(),b("div",at,[i("div",st,[f(L,null,{default:m(()=>[f(w,null,{default:m(()=>[...s[1]||(s[1]=[i("i",{class:"iconify solar--magnifer-line-duotone"},null,-1)])]),_:1}),f(S,{modelValue:I(r),"onUpdate:modelValue":s[0]||(s[0]=$=>_e(r)?r.value=$:null),placeholder:"Search ..."},null,8,["modelValue"])]),_:1}),f(re,{value:I(n),"data-key":"id"},{list:m(({items:$})=>[i("div",it,[(h(!0),b(ye,null,he($,(y,D)=>(h(),b("div",{key:D},[i("div",{class:xe(["flex flex-row gap-3 py-2",{"border-t border-surface-200 dark:border-surface-700":D!==0}])},[i("div",null,[f(j,{width:"10rem",height:"6rem",animation:"none"})]),i("div",ct,[i("div",lt,[i("div",ut,[i("h2",{class:"text-amber-500 text-2xl bold hover:underline hover:cursor-pointer",onClick:O=>a(y.id)},R(y.name),9,ft),i("span",dt,[s[2]||(s[2]=i("span",null,"Last Modified: 2024-01-01",-1)),s[3]||(s[3]=g(" / ",-1)),i("span",null,"Version: "+R(y.currentVersionId),1)]),i("div",null,[f(_,null,{default:m(()=>[...s[4]||(s[4]=[g("Worm",-1)])]),_:1})])]),i("div",mt,[y.currentVersionId?(h(),E(C,{key:0,severity:"secondary",icon:"iconify solar--file-download-line-duotone",onClick:O=>c(y.id)},null,8,["onClick"])):we("",!0),f(C,{severity:"secondary",icon:"iconify solar--copy-bold-duotone",onClick:O=>l(y.id)},null,8,["onClick"]),s[5]||(s[5]=i("div",{class:"border-l border-surface-700 mx-1"},null,-1)),f(C,{severity:"danger",icon:"iconify solar--trash-bin-trash-linear",onClick:O=>d(y.id)},null,8,["onClick"])])])])],2)]))),128))])]),empty:m(()=>[...s[6]||(s[6]=[i("div",{class:"flex flex-col justify-center items-center"},[i("span",{class:"text-xl text-surface-500 my-5"},"No Projects")],-1)])]),_:1},8,["value"])])])}}}),vt=Object.assign(pt,{__name:"LibraryTable"}),_t={class:"flex flex-col items-stretch gap-2"},yt={class:"flex flex-row justify-end"},ht=k({__name:"CreateProjectDialog",setup(e){const t=be("dialogRef"),o=U({name:""}),r=()=>{t.value.close(Ue(o.value))};return(n,a)=>{const c=F,d=Te,l=Re,u=z;return h(),b("div",_t,[f(l,null,{default:m(()=>[f(d,null,{default:m(()=>[f(c,{modelValue:I(o).name,"onUpdate:modelValue":a[0]||(a[0]=s=>I(o).name=s)},null,8,["modelValue"]),a[1]||(a[1]=i("label",null,"Index Name",-1))]),_:1})]),_:1}),i("div",yt,[f(u,{onClick:r},{default:m(()=>[...a[2]||(a[2]=[g("Create",-1)])]),_:1})])])}}}),xt=Object.assign(ht,{__name:"CreateProjectDialog"}),wt={class:"flex flex-col justify-stretch items-center py-5 h-[100%]"},bt={class:"container-fluid"},gt={class:"row"},jt={class:"col-4 flex flex-row gap-2 justify-end"},It=k({__name:"ProjectLibrary",setup(e){const{createEmptyProject:t}=V(),o=ge(),r=async()=>{o.open(xt,{props:{modal:!0,header:"New Index",style:{width:"50vw"}},onClose:async n=>{await t(n.data.name)}})};return(n,a)=>{const c=z,d=ot,l=vt,u=De;return h(),b("div",wt,[f(u,{class:"grow w-[80%]"},{content:m(()=>[i("div",bt,[i("div",gt,[a[1]||(a[1]=i("div",{class:"col-8"},[i("h1",{class:"text-primary text-3xl font-bold flex flex-row gap-1 items-center"},[i("span",null,[g(" Interactive CYOA Creator "),i("span",{class:"text-rose-500 italic"},"Neo")]),i("span",{class:"text-slate-500 text-base font-light"},"(beta)")])],-1)),i("div",jt,[f(c,{color:"primary font-medium",onClick:r},{default:m(()=>[...a[0]||(a[0]=[i("i",{class:"pi pi-plus"},null,-1),g(" New Project ",-1)])]),_:1}),f(d)])]),f(l)])]),_:1})])}}}),Lo=Object.assign(It,{__name:"ProjectLibrary"});export{Lo as default};
