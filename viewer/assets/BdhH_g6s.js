import ne from"./a8-a49c2.js";import{u as P,o as ae}from"./6hzvT-dP.js";import{i as v,_ as ie,g as se,o as T,h as ce,j as E,k as V,O as m,l as le,f as ue,m as fe,n as de,r as pe,p as me}from"./DHx07VYh.js";import{d as I,a2 as B,z as h,r as A,bS as ve,ak as ye,y as b,A as s,C as f,D as p,S as k,Z as _e,$ as he,a0 as xe,X as we,B as D,E as g,Y as be,K as ge,bT as je}from"./DdzSJcTg.js";import{_ as ke}from"./5rTHRgS3.js";import Ie from"./DJwvR4SB.js";import Se from"./DW71R-73.js";import $e from"./C9onH5Hv.js";import Ce from"./C2rt0_RV.js";import F from"./Dnjk2MVe.js";import Le from"./C3lSEtJG.js";import{Q as Oe,g as N,u as Ve,B as Pe,w as Ae}from"./lpIx-tlP.js";import{i as Ue}from"./CxzeFJE2.js";import Re from"./CdxFbylg.js";import z from"./BeDBOdWI.js";import De from"./CW5EUvFj.js";import Ne from"./VyHu6ANc.js";import"./4Yq0TogV.js";import"./CYCsxq4j.js";import"./vCC6k1YF.js";import"./nHf-jst-.js";import"./tawy0MHI.js";import"./DBYfWbxS.js";import"./B82uFDcP.js";import"./jc0MLXVe.js";import"./ZhWAdK_X.js";import"./qoB4HVZc.js";import"./CrTQrfco.js";import"./CMhfbj1E.js";import"./D9GHut1E.js";import"./m675qk77.js";import"./D0E_-NQY.js";import"./CLs7nh7g.js";import"./CmGQrYfe.js";import"./BzRqn72E.js";import"./BciKtvTx.js";import"./g2hQxUwo.js";import"./nu2iADBt.js";import"./DzQKAQGE.js";import"./BA-LYd87.js";import"./DEF_5YPs.js";import"./BHU4Xbey.js";import"./CFeJpXGj.js";import"./C-S3JTEP.js";import"./DFNegMOL.js";import"./Bn_dQIQc.js";import"./DdqGBk-8.js";import"./DEzLWorB.js";import"./m4vJiAqj.js";import"./D18zueMs.js";import"./DJJUpE4W.js";import"./BbpFMqdt.js";import"./CfOVHJNO.js";import"./CKA2__bX.js";import"./MmA3I2Zj.js";function Te(e){return v(e?.lift)}function G(e){return function(t){if(Te(t))return t.lift(function(r){try{return e(r,this)}catch(o){this.error(o)}});throw new TypeError("Unable to lift unknown Observable type")}}function Ee(e,t,r,o,n){return new Be(e,t,r,o,n)}var Be=function(e){ie(t,e);function t(r,o,n,a,c,d){var l=e.call(this,r)||this;return l.onFinalize=c,l.shouldUnsubscribe=d,l._next=o?function(u){try{o(u)}catch(i){r.error(i)}}:e.prototype._next,l._error=a?function(u){try{a(u)}catch(i){r.error(i)}finally{this.unsubscribe()}}:e.prototype._error,l._complete=n?function(){try{n()}catch(u){r.error(u)}finally{this.unsubscribe()}}:e.prototype._complete,l}return t.prototype.unsubscribe=function(){var r;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var o=this.closed;e.prototype.unsubscribe.call(this),!o&&((r=this.onFinalize)===null||r===void 0||r.call(this))}},t}(se),Y=function(e){return e&&typeof e.length=="number"&&typeof e!="function"};function Q(e){return v(e?.then)}function J(e){return v(e[T])}function K(e){return Symbol.asyncIterator&&v(e?.[Symbol.asyncIterator])}function M(e){return new TypeError("You provided "+(e!==null&&typeof e=="object"?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function Fe(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var W=Fe();function X(e){return v(e?.[W])}function Z(e){return ce(this,arguments,function(){var r,o,n,a;return E(this,function(c){switch(c.label){case 0:r=e.getReader(),c.label=1;case 1:c.trys.push([1,,9,10]),c.label=2;case 2:return[4,V(r.read())];case 3:return o=c.sent(),n=o.value,a=o.done,a?[4,V(void 0)]:[3,5];case 4:return[2,c.sent()];case 5:return[4,V(n)];case 6:return[4,c.sent()];case 7:return c.sent(),[3,2];case 8:return[3,10];case 9:return r.releaseLock(),[7];case 10:return[2]}})})}function q(e){return v(e?.getReader)}function U(e){if(e instanceof m)return e;if(e!=null){if(J(e))return ze(e);if(Y(e))return Ge(e);if(Q(e))return Ye(e);if(K(e))return H(e);if(X(e))return Qe(e);if(q(e))return Je(e)}throw M(e)}function ze(e){return new m(function(t){var r=e[T]();if(v(r.subscribe))return r.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function Ge(e){return new m(function(t){for(var r=0;r<e.length&&!t.closed;r++)t.next(e[r]);t.complete()})}function Ye(e){return new m(function(t){e.then(function(r){t.closed||(t.next(r),t.complete())},function(r){return t.error(r)}).then(null,le)})}function Qe(e){return new m(function(t){var r,o;try{for(var n=ue(e),a=n.next();!a.done;a=n.next()){var c=a.value;if(t.next(c),t.closed)return}}catch(d){r={error:d}}finally{try{a&&!a.done&&(o=n.return)&&o.call(n)}finally{if(r)throw r.error}}t.complete()})}function H(e){return new m(function(t){Ke(e,t).catch(function(r){return t.error(r)})})}function Je(e){return H(Z(e))}function Ke(e,t){var r,o,n,a;return fe(this,void 0,void 0,function(){var c,d;return E(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),r=de(e),l.label=1;case 1:return[4,r.next()];case 2:if(o=l.sent(),!!o.done)return[3,4];if(c=o.value,t.next(c),t.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return d=l.sent(),n={error:d},[3,11];case 6:return l.trys.push([6,,9,10]),o&&!o.done&&(a=r.return)?[4,a.call(r)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(n)throw n.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})}function x(e,t,r,o,n){o===void 0&&(o=0),n===void 0&&(n=!1);var a=t.schedule(function(){r(),n?e.add(this.schedule(null,o)):this.unsubscribe()},o);if(e.add(a),!n)return a}function ee(e,t){return t===void 0&&(t=0),G(function(r,o){r.subscribe(Ee(o,function(n){return x(o,e,function(){return o.next(n)},t)},function(){return x(o,e,function(){return o.complete()},t)},function(n){return x(o,e,function(){return o.error(n)},t)}))})}function te(e,t){return t===void 0&&(t=0),G(function(r,o){o.add(e.schedule(function(){return r.subscribe(o)},t))})}function Me(e,t){return U(e).pipe(te(t),ee(t))}function We(e,t){return U(e).pipe(te(t),ee(t))}function Xe(e,t){return new m(function(r){var o=0;return t.schedule(function(){o===e.length?r.complete():(r.next(e[o++]),r.closed||this.schedule())})})}function Ze(e,t){return new m(function(r){var o;return x(r,t,function(){o=e[W](),x(r,t,function(){var n,a,c;try{n=o.next(),a=n.value,c=n.done}catch(d){r.error(d);return}c?r.complete():r.next(a)},0,!0)}),function(){return v(o?.return)&&o.return()}})}function re(e,t){if(!e)throw new Error("Iterable cannot be null");return new m(function(r){x(r,t,function(){var o=e[Symbol.asyncIterator]();x(r,t,function(){o.next().then(function(n){n.done?r.complete():r.next(n.value)})},0,!0)})})}function qe(e,t){return re(Z(e),t)}function He(e,t){if(e!=null){if(J(e))return Me(e,t);if(Y(e))return Xe(e,t);if(Q(e))return We(e,t);if(K(e))return re(e,t);if(X(e))return Ze(e,t);if(q(e))return qe(e,t)}throw M(e)}function et(e,t){return t?He(e,t):U(e)}const tt=I({__name:"ProjectUpload",setup(e){const{importProjectFile:t}=P();async function r(o){const n=o.files[0],a=await pe(n);if(a&&typeof a=="string"){const c=JSON.parse(a);await t(c)}}return(o,n)=>{const a=ne;return h(),B(a,{mode:"basic","custom-upload":!0,accept:"application/json","max-file-size":100*1024*1024,auto:!0,"choose-icon":"pi pi-file-plus","choose-label":"Upload Project",onSelect:r})}}});function rt(e,t){const r=A(void 0),o=e.subscribe({next:n=>r.value=n,error:void 0});return Oe(()=>{o.unsubscribe()}),r}const ot=e=>rt(et(ve(e))),nt={class:"row pt-2"},at={class:"col-12"},it={class:"flex flex-col"},st={class:"flex flex-col grow gap-3"},ct={class:"flex flex-row items-start"},lt={class:"flex flex-col grow gap-1"},ut=["onClick"],ft={class:"text-sm text-surface-500"},dt={class:"flex flex-row gap-1"},pt=I({__name:"LibraryTable",setup(e){const{loadProject:t}=P(),r=ye(),o=A(""),n=ot(()=>r.projects.filter(u=>!u.deleted&&(Ve(o.value)||Pe(o.value.toLowerCase(),u.name.toLowerCase()))).toArray()),a=async u=>{await t(u)},c=async u=>{const i=await r.projects.get(u);if(i.currentVersionId){const w=await r.projects_versions.get(i.currentVersionId),S=JSON.stringify(w?.data),$=new Blob([S],{type:"application/json"}),j=URL.createObjectURL($),y=document.createElement("a");y.style.display="none",y.download=`project-${w.id}.json`,y.href=j,document.body.appendChild(y),y.click(),URL.revokeObjectURL(j)}},d=async u=>{await r.projects.update(u,i=>{i.deleted=!0})},l=async u=>{const i=await r.projects.get(u);if(Ue(i)){const w=me(ae(["id","currentVersionId"]),N("createdAt",new Date),N("updatedAt",new Date))(i);await r.projects.add(w)}};return(u,i)=>{const w=Le,S=F,$=Ce,j=$e,y=Se,C=ke,oe=Ie;return h(),b("div",nt,[s("div",at,[f($,null,{default:p(()=>[f(w,null,{default:p(()=>[...i[1]||(i[1]=[s("i",{class:"iconify solar--magnifer-line-duotone"},null,-1)])]),_:1}),f(S,{modelValue:k(o),"onUpdate:modelValue":i[0]||(i[0]=L=>_e(o)?o.value=L:null),placeholder:"Search ..."},null,8,["modelValue"])]),_:1}),f(oe,{value:k(n),"data-key":"id"},{list:p(({items:L})=>[s("div",it,[(h(!0),b(he,null,xe(L,(_,R)=>(h(),b("div",{key:R},[s("div",{class:we(["flex flex-row gap-3 py-2",{"border-t border-surface-200 dark:border-surface-700":R!==0}])},[s("div",null,[f(j,{width:"10rem",height:"6rem",animation:"none"})]),s("div",st,[s("div",ct,[s("div",lt,[s("h2",{class:"text-amber-500 text-2xl bold hover:underline hover:cursor-pointer",onClick:O=>a(_.id)},D(_.name),9,ut),s("span",ft,[i[2]||(i[2]=s("span",null,"Last Modified: 2024-01-01",-1)),i[3]||(i[3]=g(" / ",-1)),s("span",null,"Version: "+D(_.currentVersionId),1)]),s("div",null,[f(y,null,{default:p(()=>[...i[4]||(i[4]=[g("Worm",-1)])]),_:1})])]),s("div",dt,[_.currentVersionId?(h(),B(C,{key:0,severity:"secondary",icon:"iconify solar--file-download-line-duotone",onClick:O=>c(_.id)},null,8,["onClick"])):be("",!0),f(C,{severity:"secondary",icon:"iconify solar--copy-bold-duotone",onClick:O=>l(_.id)},null,8,["onClick"]),i[5]||(i[5]=s("div",{class:"border-l border-surface-700 mx-1"},null,-1)),f(C,{severity:"danger",icon:"iconify solar--trash-bin-trash-linear",onClick:O=>d(_.id)},null,8,["onClick"])])])])],2)]))),128))])]),empty:p(()=>[...i[6]||(i[6]=[s("div",{class:"flex flex-col justify-center items-center"},[s("span",{class:"text-xl text-surface-500 my-5"},"No Projects")],-1)])]),_:1},8,["value"])])])}}}),mt={class:"flex flex-col items-stretch gap-2"},vt={class:"flex flex-row justify-end"},yt=I({__name:"CreateProjectDialog",setup(e){const t=ge("dialogRef"),r=A({name:""}),o=()=>{t.value.close(Ae(r.value))};return(n,a)=>{const c=F,d=Ne,l=De,u=z;return h(),b("div",mt,[f(l,null,{default:p(()=>[f(d,null,{default:p(()=>[f(c,{modelValue:k(r).name,"onUpdate:modelValue":a[0]||(a[0]=i=>k(r).name=i)},null,8,["modelValue"]),a[1]||(a[1]=s("label",null,"Index Name",-1))]),_:1})]),_:1}),s("div",vt,[f(u,{onClick:o},{default:p(()=>[...a[2]||(a[2]=[g("Create",-1)])]),_:1})])])}}}),_t={class:"flex flex-col justify-stretch items-center py-5 h-[100%]"},ht={class:"container-fluid"},xt={class:"row"},wt={class:"col-4 flex flex-row gap-2 justify-end"},gr=I({__name:"ProjectLibrary",setup(e){const{createEmptyProject:t}=P(),r=je(),o=async()=>{r.open(yt,{props:{modal:!0,header:"New Index",style:{width:"50vw"}},onClose:async n=>{await t(n.data.name)}})};return(n,a)=>{const c=z,d=tt,l=pt,u=Re;return h(),b("div",_t,[f(u,{class:"grow w-[80%]"},{content:p(()=>[s("div",ht,[s("div",xt,[a[1]||(a[1]=s("div",{class:"col-8"},[s("h1",{class:"text-primary text-3xl font-bold flex flex-row gap-1 items-center"},[s("span",null,[g(" Interactive CYOA Creator "),s("span",{class:"text-rose-500 italic"},"Neo")]),s("span",{class:"text-slate-500 text-base font-light"},"(beta)")])],-1)),s("div",wt,[f(c,{color:"primary font-medium",onClick:o},{default:p(()=>[...a[0]||(a[0]=[s("i",{class:"pi pi-plus"},null,-1),g(" New Project ",-1)])]),_:1}),f(d)])]),f(l)])]),_:1})])}}});export{gr as default};
