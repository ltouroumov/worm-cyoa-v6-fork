(function(){"use strict";function g(e){return e!=null&&typeof e=="object"&&e["@@functional/placeholder"]===!0}function m(e){return function t(r){return arguments.length===0||g(r)?t:e.apply(this,arguments)}}function v(e){return function t(r,n){switch(arguments.length){case 0:return t;case 1:return g(r)?t:m(function(i){return e(r,i)});default:return g(r)&&g(n)?t:g(r)?m(function(i){return e(i,n)}):g(n)?m(function(i){return e(r,i)}):e(r,n)}}}function Rt(e,t){switch(e){case 0:return function(){return t.apply(this,arguments)};case 1:return function(r){return t.apply(this,arguments)};case 2:return function(r,n){return t.apply(this,arguments)};case 3:return function(r,n,i){return t.apply(this,arguments)};case 4:return function(r,n,i,s){return t.apply(this,arguments)};case 5:return function(r,n,i,s,o){return t.apply(this,arguments)};case 6:return function(r,n,i,s,o,u){return t.apply(this,arguments)};case 7:return function(r,n,i,s,o,u,a){return t.apply(this,arguments)};case 8:return function(r,n,i,s,o,u,a,c){return t.apply(this,arguments)};case 9:return function(r,n,i,s,o,u,a,c,_){return t.apply(this,arguments)};case 10:return function(r,n,i,s,o,u,a,c,_,l){return t.apply(this,arguments)};default:throw new Error("First argument to _arity must be a non-negative integer no greater than ten")}}function xt(e,t,r){return function(){for(var n=[],i=0,s=e,o=0,u=!1;o<t.length||i<arguments.length;){var a;o<t.length&&(!g(t[o])||i>=arguments.length)?a=t[o]:(a=arguments[i],i+=1),n[o]=a,g(a)?u=!0:s-=1,o+=1}return!u&&s<=0?r.apply(this,n):Rt(Math.max(0,s),xt(e,n,r))}}var ie=v(function(t,r){return t===1?m(r):Rt(t,xt(t,[],r))});function se(e){return function t(r,n,i){switch(arguments.length){case 0:return t;case 1:return g(r)?t:v(function(s,o){return e(r,s,o)});case 2:return g(r)&&g(n)?t:g(r)?v(function(s,o){return e(s,n,o)}):g(n)?v(function(s,o){return e(r,s,o)}):m(function(s){return e(r,n,s)});default:return g(r)&&g(n)&&g(i)?t:g(r)&&g(n)?v(function(s,o){return e(s,o,i)}):g(r)&&g(i)?v(function(s,o){return e(s,n,o)}):g(n)&&g(i)?v(function(s,o){return e(r,s,o)}):g(r)?m(function(s){return e(s,n,i)}):g(n)?m(function(s){return e(r,s,i)}):g(i)?m(function(s){return e(r,n,s)}):e(r,n,i)}}}var $=Array.isArray||function(t){return t!=null&&t.length>=0&&Object.prototype.toString.call(t)==="[object Array]"};function tr(e){return e!=null&&typeof e["@@transducer/step"]=="function"}function H(e,t,r){return function(){if(arguments.length===0)return r();var n=arguments[arguments.length-1];if(!$(n)){for(var i=0;i<e.length;){if(typeof n[e[i]]=="function")return n[e[i]].apply(n,Array.prototype.slice.call(arguments,0,-1));i+=1}if(tr(n)){var s=t.apply(null,Array.prototype.slice.call(arguments,0,-1));return s(n)}}return r.apply(this,arguments)}}function vt(e){return e&&e["@@transducer/reduced"]?e:{"@@transducer/value":e,"@@transducer/reduced":!0}}var A={init:function(){return this.xf["@@transducer/init"]()},result:function(e){return this.xf["@@transducer/result"](e)}},er=(function(){function e(t,r){this.xf=r,this.f=t,this.all=!0}return e.prototype["@@transducer/init"]=A.init,e.prototype["@@transducer/result"]=function(t){return this.all&&(t=this.xf["@@transducer/step"](t,!0)),this.xf["@@transducer/result"](t)},e.prototype["@@transducer/step"]=function(t,r){return this.f(r)||(this.all=!1,t=vt(this.xf["@@transducer/step"](t,!1))),t},e})();function rr(e){return function(t){return new er(e,t)}}var Mt=v(H(["all"],rr,function(t,r){for(var n=0;n<r.length;){if(!t(r[n]))return!1;n+=1}return!0}));function oe(e){for(var t=[],r;!(r=e.next()).done;)t.push(r.value);return t}function ue(e,t,r){for(var n=0,i=r.length;n<i;){if(e(t,r[n]))return!0;n+=1}return!1}function nr(e){var t=String(e).match(/^function (\w*)/);return t==null?"":t[1]}function z(e,t){return Object.prototype.hasOwnProperty.call(t,e)}function ir(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}var Et=typeof Object.is=="function"?Object.is:ir,ae=Object.prototype.toString,ce=(function(){return ae.call(arguments)==="[object Arguments]"?function(t){return ae.call(t)==="[object Arguments]"}:function(t){return z("callee",t)}})(),sr=!{toString:null}.propertyIsEnumerable("toString"),le=["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],fe=(function(){return arguments.propertyIsEnumerable("length")})(),or=function(t,r){for(var n=0;n<t.length;){if(t[n]===r)return!0;n+=1}return!1},Y=m(typeof Object.keys=="function"&&!fe?function(t){return Object(t)!==t?[]:Object.keys(t)}:function(t){if(Object(t)!==t)return[];var r,n,i=[],s=fe&&ce(t);for(r in t)z(r,t)&&(!s||r!=="length")&&(i[i.length]=r);if(sr)for(n=le.length-1;n>=0;)r=le[n],z(r,t)&&!or(i,r)&&(i[i.length]=r),n-=1;return i}),Nt=m(function(t){return t===null?"Null":t===void 0?"Undefined":Object.prototype.toString.call(t).slice(8,-1)});function pe(e,t,r,n){var i=oe(e),s=oe(t);function o(u,a){return Ct(u,a,r.slice(),n.slice())}return!ue(function(u,a){return!ue(o,a,u)},s,i)}function Ct(e,t,r,n){if(Et(e,t))return!0;var i=Nt(e);if(i!==Nt(t))return!1;if(typeof e["fantasy-land/equals"]=="function"||typeof t["fantasy-land/equals"]=="function")return typeof e["fantasy-land/equals"]=="function"&&e["fantasy-land/equals"](t)&&typeof t["fantasy-land/equals"]=="function"&&t["fantasy-land/equals"](e);if(typeof e.equals=="function"||typeof t.equals=="function")return typeof e.equals=="function"&&e.equals(t)&&typeof t.equals=="function"&&t.equals(e);switch(i){case"Arguments":case"Array":case"Object":if(typeof e.constructor=="function"&&nr(e.constructor)==="Promise")return e===t;break;case"Boolean":case"Number":case"String":if(!(typeof e==typeof t&&Et(e.valueOf(),t.valueOf())))return!1;break;case"Date":if(!Et(e.valueOf(),t.valueOf()))return!1;break;case"Error":return e.name===t.name&&e.message===t.message;case"RegExp":if(!(e.source===t.source&&e.global===t.global&&e.ignoreCase===t.ignoreCase&&e.multiline===t.multiline&&e.sticky===t.sticky&&e.unicode===t.unicode))return!1;break}for(var s=r.length-1;s>=0;){if(r[s]===e)return n[s]===t;s-=1}switch(i){case"Map":return e.size!==t.size?!1:pe(e.entries(),t.entries(),r.concat([e]),n.concat([t]));case"Set":return e.size!==t.size?!1:pe(e.values(),t.values(),r.concat([e]),n.concat([t]));case"Arguments":case"Array":case"Object":case"Boolean":case"Number":case"String":case"Date":case"Error":case"RegExp":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"ArrayBuffer":break;default:return!1}var o=Y(e);if(o.length!==Y(t).length)return!1;var u=r.concat([e]),a=n.concat([t]);for(s=o.length-1;s>=0;){var c=o[s];if(!(z(c,t)&&Ct(t[c],e[c],u,a)))return!1;s-=1}return!0}var Pt=v(function(t,r){return Ct(t,r,[],[])});function ur(e,t,r){var n,i;if(typeof e.indexOf=="function")switch(typeof t){case"number":if(t===0){for(n=1/t;r<e.length;){if(i=e[r],i===0&&1/i===n)return r;r+=1}return-1}else if(t!==t){for(;r<e.length;){if(i=e[r],typeof i=="number"&&i!==i)return r;r+=1}return-1}return e.indexOf(t,r);case"string":case"boolean":case"function":case"undefined":return e.indexOf(t,r);case"object":if(t===null)return e.indexOf(t,r)}for(;r<e.length;){if(Pt(e[r],t))return r;r+=1}return-1}function he(e,t){return ur(t,e,0)>=0}function et(e,t){for(var r=0,n=t.length,i=Array(n);r<n;)i[r]=e(t[r]),r+=1;return i}function Dt(e){var t=e.replace(/\\/g,"\\\\").replace(/[\b]/g,"\\b").replace(/\f/g,"\\f").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t").replace(/\v/g,"\\v").replace(/\0/g,"\\0");return'"'+t.replace(/"/g,'\\"')+'"'}var rt=function(t){return(t<10?"0":"")+t},ar=typeof Date.prototype.toISOString=="function"?function(t){return t.toISOString()}:function(t){return t.getUTCFullYear()+"-"+rt(t.getUTCMonth()+1)+"-"+rt(t.getUTCDate())+"T"+rt(t.getUTCHours())+":"+rt(t.getUTCMinutes())+":"+rt(t.getUTCSeconds())+"."+(t.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"};function cr(e){return function(){return!e.apply(this,arguments)}}function de(e,t,r){for(var n=0,i=r.length;n<i;)t=e(t,r[n]),n+=1;return t}function lr(e,t){for(var r=0,n=t.length,i=[];r<n;)e(t[r])&&(i[i.length]=t[r]),r+=1;return i}function fr(e,t){for(var r=new Map,n=t.entries(),i=n.next();!i.done;)e(i.value[1])&&r.set(i.value[0],i.value[1]),i=n.next();return r}function pr(e){return Object.prototype.toString.call(e)==="[object Map]"}function ge(e){return Object.prototype.toString.call(e)==="[object Object]"}var hr=(function(){function e(t,r){this.xf=r,this.f=t}return e.prototype["@@transducer/init"]=A.init,e.prototype["@@transducer/result"]=A.result,e.prototype["@@transducer/step"]=function(t,r){return this.f(r)?this.xf["@@transducer/step"](t,r):t},e})();function dr(e){return function(t){return new hr(e,t)}}var ye=v(H(["fantasy-land/filter","filter"],dr,function(e,t){return ge(t)?de(function(r,n){return e(t[n])&&(r[n]=t[n]),r},{},Y(t)):pr(t)?fr(e,t):lr(e,t)})),_t=v(function(t,r){return ye(cr(t),r)});function ve(e,t){var r=function(o){var u=t.concat([e]);return he(o,u)?"<Circular>":ve(o,u)},n=function(s,o){return et(function(u){return Dt(u)+": "+r(s[u])},o.slice().sort())};switch(Object.prototype.toString.call(e)){case"[object Arguments]":return"(function() { return arguments; }("+et(r,e).join(", ")+"))";case"[object Array]":return"["+et(r,e).concat(n(e,_t(function(s){return/^\d+$/.test(s)},Y(e)))).join(", ")+"]";case"[object Boolean]":return typeof e=="object"?"new Boolean("+r(e.valueOf())+")":e.toString();case"[object Date]":return"new Date("+(isNaN(e.valueOf())?r(NaN):Dt(ar(e)))+")";case"[object Map]":return"new Map("+r(Array.from(e))+")";case"[object Null]":return"null";case"[object Number]":return typeof e=="object"?"new Number("+r(e.valueOf())+")":1/e===-1/0?"-0":e.toString(10);case"[object Set]":return"new Set("+r(Array.from(e).sort())+")";case"[object String]":return typeof e=="object"?"new String("+r(e.valueOf())+")":Dt(e);case"[object Undefined]":return"undefined";default:if(typeof e.toString=="function"){var i=e.toString();if(i!=="[object Object]")return i}return"{"+n(e,Y(e)).join(", ")+"}"}}var nt=m(function(t){return ve(t,[])}),gr=v(function(t,r){if(t===r)return r;function n(a,c){if(a>c!=c>a)return c>a?c:a}var i=n(t,r);if(i!==void 0)return i;var s=n(typeof t,typeof r);if(s!==void 0)return s===typeof t?t:r;var o=nt(t),u=n(o,nt(r));return u!==void 0&&u===o?t:r}),yr=(function(){function e(t,r){this.xf=r,this.f=t}return e.prototype["@@transducer/init"]=A.init,e.prototype["@@transducer/result"]=A.result,e.prototype["@@transducer/step"]=function(t,r){return this.xf["@@transducer/step"](t,this.f(r))},e})(),_e=function(t){return function(r){return new yr(t,r)}},it=v(H(["fantasy-land/map","map"],_e,function(t,r){switch(Object.prototype.toString.call(r)){case"[object Function]":return ie(r.length,function(){return t.call(this,r.apply(this,arguments))});case"[object Object]":return de(function(n,i){return n[i]=t(r[i]),n},{},Y(r));default:return et(t,r)}})),vr=Number.isInteger||function(t){return t<<0===t};function _r(e,t){var r=e<0?t.length+e:e;return t[r]}function mr(e,t){if(t!=null)return vr(e)?_r(e,t):t[e]}var G=v(mr),wr=v(function(t,r){return it(G(t),r)});function mt(e){return Object.prototype.toString.call(e)==="[object String]"}var Bt=m(function(t){return $(t)?!0:!t||typeof t!="object"||mt(t)?!1:t.length===0?!0:t.length>0?t.hasOwnProperty(0)&&t.hasOwnProperty(t.length-1):!1}),me=typeof Symbol<"u"?Symbol.iterator:"@@iterator";function br(e,t,r){return function(i,s,o){if(Bt(o))return e(i,s,o);if(o==null)return s;if(typeof o["fantasy-land/reduce"]=="function")return t(i,s,o,"fantasy-land/reduce");if(o[me]!=null)return r(i,s,o[me]());if(typeof o.next=="function")return r(i,s,o);if(typeof o.reduce=="function")return t(i,s,o,"reduce");throw new TypeError("reduce: list must be array or iterable")}}function we(e,t,r){for(var n=0,i=r.length;n<i;){if(t=e["@@transducer/step"](t,r[n]),t&&t["@@transducer/reduced"]){t=t["@@transducer/value"];break}n+=1}return e["@@transducer/result"](t)}var Sr=v(function(t,r){return Rt(t.length,function(){return t.apply(r,arguments)})});function jr(e,t,r){for(var n=r.next();!n.done;){if(t=e["@@transducer/step"](t,n.value),t&&t["@@transducer/reduced"]){t=t["@@transducer/value"];break}n=r.next()}return e["@@transducer/result"](t)}function Ar(e,t,r,n){return e["@@transducer/result"](r[n](Sr(e["@@transducer/step"],e),t))}var qt=br(we,Ar,jr),Or=(function(){function e(t){this.f=t}return e.prototype["@@transducer/init"]=function(){throw new Error("init not implemented on XWrap")},e.prototype["@@transducer/result"]=function(t){return t},e.prototype["@@transducer/step"]=function(t,r){return this.f(t,r)},e})();function be(e){return new Or(e)}var Ir=se(function(e,t,r){return qt(typeof e=="function"?be(e):e,t,r)}),Tr=(function(){function e(t,r){this.xf=r,this.f=t,this.any=!1}return e.prototype["@@transducer/init"]=A.init,e.prototype["@@transducer/result"]=function(t){return this.any||(t=this.xf["@@transducer/step"](t,!1)),this.xf["@@transducer/result"](t)},e.prototype["@@transducer/step"]=function(t,r){return this.f(r)&&(this.any=!0,t=vt(this.xf["@@transducer/step"](t,!0))),t},e})();function Rr(e){return function(t){return new Tr(e,t)}}var J=v(H(["any"],Rr,function(t,r){for(var n=0;n<r.length;){if(t(r[n]))return!0;n+=1}return!1})),Ft=m(function(t){return t==null});function Se(e){var t=Object.prototype.toString.call(e);return t==="[object Function]"||t==="[object AsyncFunction]"||t==="[object GeneratorFunction]"||t==="[object AsyncGeneratorFunction]"}function xr(e){return function(r){for(var n,i,s,o=[],u=0,a=r.length;u<a;){if(Bt(r[u]))for(n=r[u],s=0,i=n.length;s<i;)o[o.length]=n[s],s+=1;else o[o.length]=r[u];u+=1}return o}}function Mr(e){return{"@@transducer/value":e,"@@transducer/reduced":!0}}var je="@@transducer/init",Lt="@@transducer/step",Ae="@@transducer/result",Er=(function(){function e(t){this.xf=t}return e.prototype[je]=A.init,e.prototype[Ae]=A.result,e.prototype[Lt]=function(t,r){var n=this.xf[Lt](t,r);return n["@@transducer/reduced"]?Mr(n):n},e})(),Nr=(function(){function e(t){this.xf=new Er(t)}return e.prototype[je]=A.init,e.prototype[Ae]=A.result,e.prototype[Lt]=function(t,r){return Bt(r)?qt(this.xf,t,r):we(this.xf,t,[r])},e})(),Cr=function(t){return new Nr(t)};function Pr(e){return function(t){return _e(e)(Cr(t))}}var Dr=H(["fantasy-land/chain","chain"],Pr,function(t,r){return typeof r=="function"?function(n){return t(r(n))(n)}:xr()(it(t,r))}),Oe=v(Dr);function Br(e){return new RegExp(e.source,e.flags?e.flags:(e.global?"g":"")+(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.sticky?"y":"")+(e.unicode?"u":"")+(e.dotAll?"s":""))}function Ie(e,t,r){if(r||(r=new Fr),qr(e))return e;var n=function(s){var o=r.get(e);if(o)return o;r.set(e,s);for(var u in e)Object.prototype.hasOwnProperty.call(e,u)&&(s[u]=e[u]);return s};switch(Nt(e)){case"Object":return n(Object.create(Object.getPrototypeOf(e)));case"Array":return n(Array(e.length));case"Date":return new Date(e.valueOf());case"RegExp":return Br(e);case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":return e.slice();default:return e}}function qr(e){var t=typeof e;return e==null||t!="object"&&t!="function"}var Fr=(function(){function e(){this.map={},this.length=0}return e.prototype.set=function(t,r){var n=this.hash(t),i=this.map[n];i||(this.map[n]=i=[]),i.push([t,r]),this.length+=1},e.prototype.hash=function(t){var r=[];for(var n in t)r.push(Object.prototype.toString.call(t[n]));return r.join()},e.prototype.get=function(t){if(this.length<=180){for(var r in this.map)for(var o=this.map[r],n=0;n<o.length;n+=1){var i=o[n];if(i[0]===t)return i[1]}return}var s=this.hash(t),o=this.map[s];if(o)for(var n=0;n<o.length;n+=1){var i=o[n];if(i[0]===t)return i[1]}},e})();function Lr(e,t){return function(){var r=arguments.length;if(r===0)return t();var n=arguments[r-1];return $(n)||typeof n[e]!="function"?t.apply(this,arguments):n[e].apply(n,Array.prototype.slice.call(arguments,0,r-1))}}var Te=se(Lr("slice",function(t,r,n){return Array.prototype.slice.call(n,t,r)})),Kr=v(function(t,r){if($(t)){if($(r))return t.concat(r);throw new TypeError(nt(r)+" is not an array")}if(mt(t)){if(mt(r))return t+r;throw new TypeError(nt(r)+" is not a string")}if(t!=null&&Se(t["fantasy-land/concat"]))return t["fantasy-land/concat"](r);if(t!=null&&Se(t.concat))return t.concat(r);throw new TypeError(nt(t)+' does not have a method named "concat" or "fantasy-land/concat"')}),Ur=v(function(t,r){return ie(Ir(gr,0,wr("length",r)),function(){var n=arguments,i=this;return t.apply(i,et(function(s){return s.apply(i,n)},r))})}),Wr=(function(){function e(t,r,n,i){this.valueFn=t,this.valueAcc=r,this.keyFn=n,this.xf=i,this.inputs={}}return e.prototype["@@transducer/init"]=A.init,e.prototype["@@transducer/result"]=function(t){var r;for(r in this.inputs)if(z(r,this.inputs)&&(t=this.xf["@@transducer/step"](t,this.inputs[r]),t["@@transducer/reduced"])){t=t["@@transducer/value"];break}return this.inputs=null,this.xf["@@transducer/result"](t)},e.prototype["@@transducer/step"]=function(t,r){var n=this.keyFn(r);return this.inputs[n]=this.inputs[n]||[n,Ie(this.valueAcc)],this.inputs[n][1]=this.valueFn(this.inputs[n][1],r),t},e})();function Xr(e,t,r){return function(n){return new Wr(e,t,r,n)}}var Hr=xt(4,[],H([],Xr,function(t,r,n,i){var s=be(function(o,u){var a=n(u),c=t(z(a,o)?o[a]:Ie(r),u);return c&&c["@@transducer/reduced"]?vt(o):(o[a]=c,o)});return qt(s,{},i)})),kr=(function(){function e(t,r){this.xf=r,this.n=t,this.i=0}return e.prototype["@@transducer/init"]=A.init,e.prototype["@@transducer/result"]=A.result,e.prototype["@@transducer/step"]=function(t,r){this.i+=1;var n=this.n===0?t:this.xf["@@transducer/step"](t,r);return this.n>=0&&this.i>=this.n?vt(n):n},e})();function Vr(e){return function(t){return new kr(e,t)}}var $r=v(H(["take"],Vr,function(t,r){return Te(0,t<0?1/0:t,r)}));function zr(e){var t=Object.prototype.toString.call(e);return t==="[object Uint8ClampedArray]"||t==="[object Int8Array]"||t==="[object Uint8Array]"||t==="[object Int16Array]"||t==="[object Uint16Array]"||t==="[object Int32Array]"||t==="[object Uint32Array]"||t==="[object Float32Array]"||t==="[object Float64Array]"||t==="[object BigInt64Array]"||t==="[object BigUint64Array]"}var Yr=m(function(t){return t!=null&&typeof t["fantasy-land/empty"]=="function"?t["fantasy-land/empty"]():t!=null&&t.constructor!=null&&typeof t.constructor["fantasy-land/empty"]=="function"?t.constructor["fantasy-land/empty"]():t!=null&&typeof t.empty=="function"?t.empty():t!=null&&t.constructor!=null&&typeof t.constructor.empty=="function"?t.constructor.empty():t==Set||t instanceof Set?new Set:t==Map||t instanceof Map?new Map:$(t)?[]:mt(t)?"":ge(t)?{}:ce(t)?(function(){return arguments})():zr(t)?t.constructor.from(""):void 0}),Re=v(he),xe=Hr(function(e,t){return t},null),wt=m(function(t){return t!=null&&Pt(t,Yr(t))}),Kt=m(function(t){return!wt(t)}),Ut=m(function(t){return!Ft(t)}),Gr=m(function(t){return Ur(function(){return Array.prototype.slice.call(arguments,0)},t)});function Jr(e){return Object.prototype.toString.call(e)==="[object Number]"}var Me=m(function(t){return t!=null&&Jr(t.length)?t.length:NaN}),Zr=Gr([ye,_t]),Qr=v(function(e,t){return Pt($r(e.length,t),e)});const E=Symbol.for("@ts-pattern/matcher"),tn=Symbol.for("@ts-pattern/isVariadic"),bt="@ts-pattern/anonymous-select-key",Wt=e=>!!(e&&typeof e=="object"),St=e=>e&&!!e[E],R=(e,t,r)=>{if(St(e)){const n=e[E](),{matched:i,selections:s}=n.match(t);return i&&s&&Object.keys(s).forEach(o=>r(o,s[o])),i}if(Wt(e)){if(!Wt(t))return!1;if(Array.isArray(e)){if(!Array.isArray(t))return!1;let n=[],i=[],s=[];for(const o of e.keys()){const u=e[o];St(u)&&u[tn]?s.push(u):s.length?i.push(u):n.push(u)}if(s.length){if(s.length>1)throw new Error("Pattern error: Using `...P.array(...)` several times in a single pattern is not allowed.");if(t.length<n.length+i.length)return!1;const o=t.slice(0,n.length),u=i.length===0?[]:t.slice(-i.length),a=t.slice(n.length,i.length===0?1/0:-i.length);return n.every((c,_)=>R(c,o[_],r))&&i.every((c,_)=>R(c,u[_],r))&&(s.length===0||R(s[0],a,r))}return e.length===t.length&&e.every((o,u)=>R(o,t[u],r))}return Reflect.ownKeys(e).every(n=>{const i=e[n];return(n in t||St(s=i)&&s[E]().matcherType==="optional")&&R(i,t[n],r);var s})}return Object.is(t,e)},P=e=>{var t,r,n;return Wt(e)?St(e)?(t=(r=(n=e[E]()).getSelectionKeys)==null?void 0:r.call(n))!=null?t:[]:Array.isArray(e)?st(e,P):st(Object.values(e),P):[]},st=(e,t)=>e.reduce((r,n)=>r.concat(t(n)),[]);function O(e){return Object.assign(e,{optional:()=>en(e),and:t=>y(e,t),or:t=>rn(e,t),select:t=>t===void 0?Ee(e):Ee(t,e)})}function en(e){return O({[E]:()=>({match:t=>{let r={};const n=(i,s)=>{r[i]=s};return t===void 0?(P(e).forEach(i=>n(i,void 0)),{matched:!0,selections:r}):{matched:R(e,t,n),selections:r}},getSelectionKeys:()=>P(e),matcherType:"optional"})})}function y(...e){return O({[E]:()=>({match:t=>{let r={};const n=(i,s)=>{r[i]=s};return{matched:e.every(i=>R(i,t,n)),selections:r}},getSelectionKeys:()=>st(e,P),matcherType:"and"})})}function rn(...e){return O({[E]:()=>({match:t=>{let r={};const n=(i,s)=>{r[i]=s};return st(e,P).forEach(i=>n(i,void 0)),{matched:e.some(i=>R(i,t,n)),selections:r}},getSelectionKeys:()=>st(e,P),matcherType:"or"})})}function h(e){return{[E]:()=>({match:t=>({matched:!!e(t)})})}}function Ee(...e){const t=typeof e[0]=="string"?e[0]:void 0,r=e.length===2?e[1]:typeof e[0]=="string"?void 0:e[0];return O({[E]:()=>({match:n=>{let i={[t??bt]:n};return{matched:r===void 0||R(r,n,(s,o)=>{i[s]=o}),selections:i}},getSelectionKeys:()=>[t??bt].concat(r===void 0?[]:P(r))})})}function Ne(e){return!0}function x(e){return typeof e=="number"}function D(e){return typeof e=="string"}function B(e){return typeof e=="bigint"}O(h(Ne)),O(h(Ne));const q=e=>Object.assign(O(e),{startsWith:t=>{return q(y(e,(r=t,h(n=>D(n)&&n.startsWith(r)))));var r},endsWith:t=>{return q(y(e,(r=t,h(n=>D(n)&&n.endsWith(r)))));var r},minLength:t=>q(y(e,(r=>h(n=>D(n)&&n.length>=r))(t))),length:t=>q(y(e,(r=>h(n=>D(n)&&n.length===r))(t))),maxLength:t=>q(y(e,(r=>h(n=>D(n)&&n.length<=r))(t))),includes:t=>{return q(y(e,(r=t,h(n=>D(n)&&n.includes(r)))));var r},regex:t=>{return q(y(e,(r=t,h(n=>D(n)&&!!n.match(r)))));var r}});q(h(D));const M=e=>Object.assign(O(e),{between:(t,r)=>M(y(e,((n,i)=>h(s=>x(s)&&n<=s&&i>=s))(t,r))),lt:t=>M(y(e,(r=>h(n=>x(n)&&n<r))(t))),gt:t=>M(y(e,(r=>h(n=>x(n)&&n>r))(t))),lte:t=>M(y(e,(r=>h(n=>x(n)&&n<=r))(t))),gte:t=>M(y(e,(r=>h(n=>x(n)&&n>=r))(t))),int:()=>M(y(e,h(t=>x(t)&&Number.isInteger(t)))),finite:()=>M(y(e,h(t=>x(t)&&Number.isFinite(t)))),positive:()=>M(y(e,h(t=>x(t)&&t>0))),negative:()=>M(y(e,h(t=>x(t)&&t<0)))});M(h(x));const F=e=>Object.assign(O(e),{between:(t,r)=>F(y(e,((n,i)=>h(s=>B(s)&&n<=s&&i>=s))(t,r))),lt:t=>F(y(e,(r=>h(n=>B(n)&&n<r))(t))),gt:t=>F(y(e,(r=>h(n=>B(n)&&n>r))(t))),lte:t=>F(y(e,(r=>h(n=>B(n)&&n<=r))(t))),gte:t=>F(y(e,(r=>h(n=>B(n)&&n>=r))(t))),positive:()=>F(y(e,h(t=>B(t)&&t>0))),negative:()=>F(y(e,h(t=>B(t)&&t<0)))});F(h(B)),O(h(function(e){return typeof e=="boolean"})),O(h(function(e){return typeof e=="symbol"})),O(h(function(e){return e==null})),O(h(function(e){return e!=null}));class nn extends Error{constructor(t){let r;try{r=JSON.stringify(t)}catch{r=t}super(`Pattern matching error: no pattern matches value ${r}`),this.input=void 0,this.input=t}}const Xt={matched:!1,value:void 0};function sn(e){return new jt(e,Xt)}class jt{constructor(t,r){this.input=void 0,this.state=void 0,this.input=t,this.state=r}with(...t){if(this.state.matched)return this;const r=t[t.length-1],n=[t[0]];let i;t.length===3&&typeof t[1]=="function"?i=t[1]:t.length>2&&n.push(...t.slice(1,t.length-1));let s=!1,o={};const u=(c,_)=>{s=!0,o[c]=_},a=!n.some(c=>R(c,this.input,u))||i&&!i(this.input)?Xt:{matched:!0,value:r(s?bt in o?o[bt]:o:this.input,this.input)};return new jt(this.input,a)}when(t,r){if(this.state.matched)return this;const n=!!t(this.input);return new jt(this.input,n?{matched:!0,value:r(this.input,this.input)}:Xt)}otherwise(t){return this.state.matched?this.state.value:t(this.input)}exhaustive(t=on){return this.state.matched?this.state.value:t(this.input)}run(){return this.exhaustive()}returnType(){return this}narrow(){return this}}function on(e){throw new nn(e)}function un(e){const t=Object.create(null);for(const r of e.split(","))t[r]=1;return r=>r in t}const an=Object.assign,cn=Object.prototype.hasOwnProperty,Ht=(e,t)=>cn.call(e,t),ot=Array.isArray,At=e=>Ce(e)==="[object Map]",ln=e=>typeof e=="function",fn=e=>typeof e=="string",ut=e=>typeof e=="symbol",at=e=>e!==null&&typeof e=="object",pn=Object.prototype.toString,Ce=e=>pn.call(e),hn=e=>Ce(e).slice(8,-1),kt=e=>fn(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Z=(e,t)=>!Object.is(e,t);let Pe;const Vt=()=>Pe||(Pe=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let w,De=0,ct,lt;function dn(e,t=!1){if(e.flags|=8,t){e.next=lt,lt=e;return}e.next=ct,ct=e}function $t(){De++}function zt(){if(--De>0)return;if(lt){let t=lt;for(lt=void 0;t;){const r=t.next;t.next=void 0,t.flags&=-9,t=r}}let e;for(;ct;){let t=ct;for(ct=void 0;t;){const r=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(n){e||(e=n)}t=r}}if(e)throw e}function gn(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function yn(e){let t,r=e.depsTail,n=r;for(;n;){const i=n.prevDep;n.version===-1?(n===r&&(r=i),qe(n),_n(n)):t=n,n.dep.activeLink=n.prevActiveLink,n.prevActiveLink=void 0,n=i}e.deps=t,e.depsTail=r}function vn(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(Be(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function Be(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===ft)||(e.globalVersion=ft,!e.isSSR&&e.flags&128&&(!e.deps&&!e._dirty||!vn(e))))return;e.flags|=2;const t=e.dep,r=w,n=L;w=e,L=!0;try{gn(e);const i=e.fn(e._value);(t.version===0||Z(i,e._value))&&(e.flags|=128,e._value=i,t.version++)}catch(i){throw t.version++,i}finally{w=r,L=n,yn(e),e.flags&=-3}}function qe(e,t=!1){const{dep:r,prevSub:n,nextSub:i}=e;if(n&&(n.nextSub=i,e.prevSub=void 0),i&&(i.prevSub=n,e.nextSub=void 0),r.subs===e&&(r.subs=n,!n&&r.computed)){r.computed.flags&=-5;for(let s=r.computed.deps;s;s=s.nextDep)qe(s,!0)}!t&&!--r.sc&&r.map&&r.map.delete(r.key)}function _n(e){const{prevDep:t,nextDep:r}=e;t&&(t.nextDep=r,e.prevDep=void 0),r&&(r.prevDep=t,e.nextDep=void 0)}let L=!0;const Fe=[];function mn(){Fe.push(L),L=!1}function wn(){const e=Fe.pop();L=e===void 0?!0:e}let ft=0;class bn{constructor(t,r){this.sub=t,this.dep=r,this.version=r.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Yt{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!w||!L||w===this.computed)return;let r=this.activeLink;if(r===void 0||r.sub!==w)r=this.activeLink=new bn(w,this),w.deps?(r.prevDep=w.depsTail,w.depsTail.nextDep=r,w.depsTail=r):w.deps=w.depsTail=r,Le(r);else if(r.version===-1&&(r.version=this.version,r.nextDep)){const n=r.nextDep;n.prevDep=r.prevDep,r.prevDep&&(r.prevDep.nextDep=n),r.prevDep=w.depsTail,r.nextDep=void 0,w.depsTail.nextDep=r,w.depsTail=r,w.deps===r&&(w.deps=n)}return r}trigger(t){this.version++,ft++,this.notify(t)}notify(t){$t();try{for(let r=this.subs;r;r=r.prevSub)r.sub.notify()&&r.sub.dep.notify()}finally{zt()}}}function Le(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let n=t.deps;n;n=n.nextDep)Le(n)}const r=e.dep.subs;r!==e&&(e.prevSub=r,r&&(r.nextSub=e)),e.dep.subs=e}}const Gt=new WeakMap,k=Symbol(""),Jt=Symbol(""),pt=Symbol("");function j(e,t,r){if(L&&w){let n=Gt.get(e);n||Gt.set(e,n=new Map);let i=n.get(r);i||(n.set(r,i=new Yt),i.map=n,i.key=r),i.track()}}function K(e,t,r,n,i,s){const o=Gt.get(e);if(!o){ft++;return}const u=a=>{a&&a.trigger()};if($t(),t==="clear")o.forEach(u);else{const a=ot(e),c=a&&kt(r);if(a&&r==="length"){const _=Number(n);o.forEach((l,f)=>{(f==="length"||f===pt||!ut(f)&&f>=_)&&u(l)})}else switch((r!==void 0||o.has(void 0))&&u(o.get(r)),c&&u(o.get(pt)),t){case"add":a?c&&u(o.get("length")):(u(o.get(k)),At(e)&&u(o.get(Jt)));break;case"delete":a||(u(o.get(k)),At(e)&&u(o.get(Jt)));break;case"set":At(e)&&u(o.get(k));break}}zt()}function Q(e){const t=d(e);return t===e?t:(j(t,"iterate",pt),X(e)?t:t.map(C))}function Zt(e){return j(e=d(e),"iterate",pt),e}function U(e,t){return W(e)?ze(e)?dt(C(t)):dt(t):C(t)}const Sn={__proto__:null,[Symbol.iterator](){return Qt(this,Symbol.iterator,e=>U(this,e))},concat(...e){return Q(this).concat(...e.map(t=>ot(t)?Q(t):t))},entries(){return Qt(this,"entries",e=>(e[1]=U(this,e[1]),e))},every(e,t){return N(this,"every",e,t,void 0,arguments)},filter(e,t){return N(this,"filter",e,t,r=>r.map(n=>U(this,n)),arguments)},find(e,t){return N(this,"find",e,t,r=>U(this,r),arguments)},findIndex(e,t){return N(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return N(this,"findLast",e,t,r=>U(this,r),arguments)},findLastIndex(e,t){return N(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return N(this,"forEach",e,t,void 0,arguments)},includes(...e){return te(this,"includes",e)},indexOf(...e){return te(this,"indexOf",e)},join(e){return Q(this).join(e)},lastIndexOf(...e){return te(this,"lastIndexOf",e)},map(e,t){return N(this,"map",e,t,void 0,arguments)},pop(){return ht(this,"pop")},push(...e){return ht(this,"push",e)},reduce(e,...t){return Ke(this,"reduce",e,t)},reduceRight(e,...t){return Ke(this,"reduceRight",e,t)},shift(){return ht(this,"shift")},some(e,t){return N(this,"some",e,t,void 0,arguments)},splice(...e){return ht(this,"splice",e)},toReversed(){return Q(this).toReversed()},toSorted(e){return Q(this).toSorted(e)},toSpliced(...e){return Q(this).toSpliced(...e)},unshift(...e){return ht(this,"unshift",e)},values(){return Qt(this,"values",e=>U(this,e))}};function Qt(e,t,r){const n=Zt(e),i=n[t]();return n!==e&&!X(e)&&(i._next=i.next,i.next=()=>{const s=i._next();return s.done||(s.value=r(s.value)),s}),i}const jn=Array.prototype;function N(e,t,r,n,i,s){const o=Zt(e),u=o!==e&&!X(e),a=o[t];if(a!==jn[t]){const l=a.apply(e,s);return u?C(l):l}let c=r;o!==e&&(u?c=function(l,f){return r.call(this,U(e,l),f,e)}:r.length>2&&(c=function(l,f){return r.call(this,l,f,e)}));const _=a.call(o,c,n);return u&&i?i(_):_}function Ke(e,t,r,n){const i=Zt(e);let s=r;return i!==e&&(X(e)?r.length>3&&(s=function(o,u,a){return r.call(this,o,u,a,e)}):s=function(o,u,a){return r.call(this,o,U(e,u),a,e)}),i[t](s,...n)}function te(e,t,r){const n=d(e);j(n,"iterate",pt);const i=n[t](...r);return(i===-1||i===!1)&&Fn(r[0])?(r[0]=d(r[0]),n[t](...r)):i}function ht(e,t,r=[]){mn(),$t();const n=d(e)[t].apply(e,r);return zt(),wn(),n}const An=un("__proto__,__v_isRef,__isVue"),Ue=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(ut));function On(e){ut(e)||(e=String(e));const t=d(this);return j(t,"has",e),t.hasOwnProperty(e)}class We{constructor(t=!1,r=!1){this._isReadonly=t,this._isShallow=r}get(t,r,n){if(r==="__v_skip")return t.__v_skip;const i=this._isReadonly,s=this._isShallow;if(r==="__v_isReactive")return!i;if(r==="__v_isReadonly")return i;if(r==="__v_isShallow")return s;if(r==="__v_raw")return n===(i?s?Dn:ke:s?Pn:He).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(n)?t:void 0;const o=ot(t);if(!i){let a;if(o&&(a=Sn[r]))return a;if(r==="hasOwnProperty")return On}const u=Reflect.get(t,r,tt(t)?t:n);if((ut(r)?Ue.has(r):An(r))||(i||j(t,"get",r),s))return u;if(tt(u)){const a=o&&kt(r)?u:u.value;return i&&at(a)?re(a):a}return at(u)?i?re(u):Ve(u):u}}class In extends We{constructor(t=!1){super(!1,t)}set(t,r,n,i){let s=t[r];const o=ot(t)&&kt(r);if(!this._isShallow){const c=W(s);if(!X(n)&&!W(n)&&(s=d(s),n=d(n)),!o&&tt(s)&&!tt(n))return c||(s.value=n),!0}const u=o?Number(r)<t.length:Ht(t,r),a=Reflect.set(t,r,n,tt(t)?t:i);return t===d(i)&&(u?Z(n,s)&&K(t,"set",r,n):K(t,"add",r,n)),a}deleteProperty(t,r){const n=Ht(t,r);t[r];const i=Reflect.deleteProperty(t,r);return i&&n&&K(t,"delete",r,void 0),i}has(t,r){const n=Reflect.has(t,r);return(!ut(r)||!Ue.has(r))&&j(t,"has",r),n}ownKeys(t){return j(t,"iterate",ot(t)?"length":k),Reflect.ownKeys(t)}}class Tn extends We{constructor(t=!1){super(!0,t)}set(t,r){return!0}deleteProperty(t,r){return!0}}const Rn=new In,xn=new Tn,ee=e=>e,Ot=e=>Reflect.getPrototypeOf(e);function Mn(e,t,r){return function(...n){const i=this.__v_raw,s=d(i),o=At(s),u=e==="entries"||e===Symbol.iterator&&o,a=e==="keys"&&o,c=i[e](...n),_=r?ee:t?dt:C;return!t&&j(s,"iterate",a?Jt:k),{next(){const{value:l,done:f}=c.next();return f?{value:l,done:f}:{value:u?[_(l[0]),_(l[1])]:_(l),done:f}},[Symbol.iterator](){return this}}}}function It(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function En(e,t){const r={get(i){const s=this.__v_raw,o=d(s),u=d(i);e||(Z(i,u)&&j(o,"get",i),j(o,"get",u));const{has:a}=Ot(o),c=t?ee:e?dt:C;if(a.call(o,i))return c(s.get(i));if(a.call(o,u))return c(s.get(u));s!==o&&s.get(i)},get size(){const i=this.__v_raw;return!e&&j(d(i),"iterate",k),i.size},has(i){const s=this.__v_raw,o=d(s),u=d(i);return e||(Z(i,u)&&j(o,"has",i),j(o,"has",u)),i===u?s.has(i):s.has(i)||s.has(u)},forEach(i,s){const o=this,u=o.__v_raw,a=d(u),c=t?ee:e?dt:C;return!e&&j(a,"iterate",k),u.forEach((_,l)=>i.call(s,c(_),c(l),o))}};return an(r,e?{add:It("add"),set:It("set"),delete:It("delete"),clear:It("clear")}:{add(i){!t&&!X(i)&&!W(i)&&(i=d(i));const s=d(this);return Ot(s).has.call(s,i)||(s.add(i),K(s,"add",i,i)),this},set(i,s){!t&&!X(s)&&!W(s)&&(s=d(s));const o=d(this),{has:u,get:a}=Ot(o);let c=u.call(o,i);c||(i=d(i),c=u.call(o,i));const _=a.call(o,i);return o.set(i,s),c?Z(s,_)&&K(o,"set",i,s):K(o,"add",i,s),this},delete(i){const s=d(this),{has:o,get:u}=Ot(s);let a=o.call(s,i);a||(i=d(i),a=o.call(s,i)),u&&u.call(s,i);const c=s.delete(i);return a&&K(s,"delete",i,void 0),c},clear(){const i=d(this),s=i.size!==0,o=i.clear();return s&&K(i,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(i=>{r[i]=Mn(i,e,t)}),r}function Xe(e,t){const r=En(e,t);return(n,i,s)=>i==="__v_isReactive"?!e:i==="__v_isReadonly"?e:i==="__v_raw"?n:Reflect.get(Ht(r,i)&&i in n?r:n,i,s)}const Nn={get:Xe(!1,!1)},Cn={get:Xe(!0,!1)},He=new WeakMap,Pn=new WeakMap,ke=new WeakMap,Dn=new WeakMap;function Bn(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function qn(e){return e.__v_skip||!Object.isExtensible(e)?0:Bn(hn(e))}function Ve(e){return W(e)?e:$e(e,!1,Rn,Nn,He)}function re(e){return $e(e,!0,xn,Cn,ke)}function $e(e,t,r,n,i){if(!at(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const s=qn(e);if(s===0)return e;const o=i.get(e);if(o)return o;const u=new Proxy(e,s===2?n:r);return i.set(e,u),u}function ze(e){return W(e)?ze(e.__v_raw):!!(e&&e.__v_isReactive)}function W(e){return!!(e&&e.__v_isReadonly)}function X(e){return!!(e&&e.__v_isShallow)}function Fn(e){return e?!!e.__v_raw:!1}function d(e){const t=e&&e.__v_raw;return t?d(t):e}const C=e=>at(e)?Ve(e):e,dt=e=>at(e)?re(e):e;function tt(e){return e?e.__v_isRef===!0:!1}function Ln(e){return Kn(e,!1)}function Kn(e,t){return tt(e)?e:new Un(e,t)}class Un{constructor(t,r){this.dep=new Yt,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=r?t:d(t),this._value=r?t:C(t),this.__v_isShallow=r}get value(){return this.dep.track(),this._value}set value(t){const r=this._rawValue,n=this.__v_isShallow||X(t)||W(t);t=n?t:d(t),Z(t,r)&&(this._rawValue=t,this._value=n?t:C(t),this.dep.trigger())}}class Wn{constructor(t,r,n){this.fn=t,this.setter=r,this._value=void 0,this.dep=new Yt(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=ft-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!r,this.isSSR=n}notify(){if(this.flags|=16,!(this.flags&8)&&w!==this)return dn(this,!0),!0}get value(){const t=this.dep.track();return Be(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function Xn(e,t,r=!1){let n,i;return ln(e)?n=e:(n=e.get,i=e.set),new Wn(n,i,r)}Vt().requestIdleCallback,Vt().cancelIdleCallback;{const e=Vt(),t=(r,n)=>{let i;return(i=e[r])||(i=e[r]=[]),i.push(n),s=>{i.length>1?i.forEach(o=>o(s)):i[0](s)}};t("__VUE_INSTANCE_SETTERS__",r=>r),t("__VUE_SSR_SETTERS__",r=>Ye=r)}let Ye=!1;const Ge=(e,t)=>Xn(e,t,Ye),gt=Ln(null),Hn=Ge(()=>{const e=xe(G("id"),Oe(G("objects"),gt.value?.rows??[]));return t=>e[t]}),kn=Ge(()=>{const e=xe(G("id"),gt.value?.pointTypes??[]);return t=>e[t]});self.addEventListener("message",e=>{const{event:t,replyTo:r=null}=e.data;try{const n=JSON.parse(t);sn(n).with({type:"init"},({project:i})=>{gt.value=i}).with({type:"search"},({query:i})=>{if(!gt.value)postMessage({replyTo:r,message:JSON.stringify({results:[]})});else{const s=Vn(i),o=s.length;postMessage({replyTo:r,message:JSON.stringify({count:o,results:Te(0,Math.min(Yn,o),s)})})}}).exhaustive()}catch(n){console.log("error in search worker",n)}});function Vn(e){const t=e.trim().toLowerCase();if(wt(t))return[];const r=zn(t),n=[];for(const i of gt.value.rows)for(const s of i.objects){r({type:"object",data:s,parent:i})&&n.push({type:"object",rowId:i.id,objId:s.id});for(let u=0;u<s.addons.length;u++){const a=s.addons[u];r({type:"addon",data:a,parent:s})&&n.push({type:"addon",rowId:i.id,objId:s.id,addonId:a.id||u})}}return n}function Je(e){const t={};for(const r of e){const n=r.groups?.quoted??r.groups?.word;if(!(Ft(n)||wt(n)))if(r.groups?.key){const i=r.groups.key;t.kwargs||(t.kwargs={}),t.kwargs[i]||(t.kwargs[i]=[]),t.kwargs[i].push(n)}else t.args||(t.args=[]),t.args.push(n)}return t}function $n(e){const t=e.matchAll(Gn),r=[];let n=[];for(const i of t)i[0]==="or"?(r.push(n),n=[]):n.push(i);return r.push(n),r.length>1?{or:r.map(Je).filter(Kt)}:Je(n)}function zn(e){const t=e.toLowerCase().split(/\s+/);if(Me(t)===0)return()=>!1;const r=$n(e),n=(l,f)=>Qr("~",l)?!Re(l.slice(1),f):Re(l,f),i=(l,f)=>{const p=f.toLowerCase();return J(b=>n(b,p),l)},s=(l,f)=>{const p=f.toLowerCase();return Mt(b=>n(b,p),l)},o=l=>{const f=it(p=>Hn.value(p)?.title,l);return _t(Ft,f)},u=l=>Oe(p=>p.showRequired?_t(wt,Kr([p.reqId,p.reqId1,p.reqId2,p.reqId3],it(G("req"),p.orRequired))):[],l),a=l=>f=>f.type==="object"&&l.onObject?l.onObject(f.data,f.parent):f.type==="addon"&&l.onAddon?l.onAddon(f.data,f.parent):l.onBoth?l.onBoth(f.data,f.parent):!1,c=(l,f)=>{const p=it(I=>{const V=Jn.exec(I);if(!V)return null;const{operator:T,value:Zn,name:Ze}=V.groups,Tt=parseInt(Zn,10);return isNaN(Tt)?null:{relative:T===">"||T==="<",exec:Qe=>{const Qn=kn.value(Qe.id);if(Ut(Ze)&&Qn.afterText.toLowerCase()!==Ze.toLowerCase())return!1;const yt=parseInt(Qe.value);if(isNaN(yt))return!1;if(f==="cost"&&yt<0)return!1;if(f==="gain"&&yt>0)return!1;const ne=f==="gain"?-yt:yt;return T===">"?ne>=Tt:T==="<"?ne<=Tt:ne===Tt}}},l).filter(Ut),[b,S]=Zr(G("relative"),p);return a({onObject:I=>J(V=>Kt(b)&&Mt(T=>T.exec(V),b)||Kt(S)&&J(T=>T.exec(V),S),I.scores)})};function _(l){if("or"in l){const f=l.or.map(p=>_(p));return p=>J(b=>b(p),f)}else{const f=l.args??[],p=l.kwargs??{},b=[];return Me(f)>0&&b.push(a({onBoth:S=>s(f,S.title)||s(f,S.text)})),"id"in p&&b.push(a({onBoth:S=>Ut(S.id)&&i(p.id,S.id)})),"title"in p&&b.push(a({onBoth:S=>s(p.title,S.title)})),"text"in p&&b.push(a({onBoth:S=>s(p.text,S.text)})),"parent"in p&&b.push(a({onBoth:(S,I)=>s(p.parent,I.title)})),"row"in p&&b.push(a({onObject:(S,I)=>s(p.row,I.title)})),"required"in p&&b.push(a({onBoth:S=>{const I=u(S.requireds),V=o(I);return J(T=>s(p.required,T),V)||J(T=>i(p.required,T),I)}})),"cost"in p&&b.push(c(p.cost,"cost")),"gain"in p&&b.push(c(p.gain,"gain")),S=>Mt(I=>I(S),b)}}return _(r)}const Yn=500,Gn=/(?:(?<key>\S+):)?(?:"(?<quoted>[^"]+)"|(?<word>\S+))/g,Jn=/^(?<operator>[<>])?\s*(?<value>\d+)\s*(?<name>\w+)?$/})();
